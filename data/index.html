<html>

<head>
    <title>AGIS Dashboard</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://code.highcharts.com/highcharts.js"></script>
    <script src="https://code.highcharts.com/modules/exporting.js"></script>
    <script src="https://code.highcharts.com/modules/export-data.js"></script>
    <script src="https://code.highcharts.com/modules/accessibility.js"></script>
    <script></script>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <form oninput="calculateTargetDripRate()">
        <!-- Total volume to be infused -->
        <div>Total volume to be infused (VTBI):</div>
        <input type="text" id="VTBI" name="VTBI" required>
        <label for="fname">mL</label><br>

        <!-- Total time -->
        <!-- TODO: some cases you don't need to fill in both hours and minutes -->
        <div>Total time:</div>
        <input type="text" id="total_time_hours" name="total_time_hours" required>
        <label for="total_time_hours">hours</label>
        <input type="text" id="total_time_minutes" name="total_time_minutes" required>
        <label for="total_time_minutes">minutes</label><br>

        <!-- Drop factor -->
        <div>Drop factor:</div>
        <input type="radio" id="drop_factor_10" name="drop_factor" value="10" required>
        <label for="drop_factor_10">10 drops/mL</label><br>

        <input type="radio" id="drop_factor_15" name="drop_factor" value="15">
        <label for="drop_factor_15">15 drops/mL</label><br>

        <input type="radio" id="drop_factor_20" name="drop_factor" value="20">
        <label for="drop_factor_20">20 drops/mL</label><br>

        <input type="radio" id="drop_factor_60" name="drop_factor" value="60">
        <label for="drop_factor_60">60 drops/mL</label><br><br>

        <!-- Derive the drip rate based on inputs -->
        <div>Drip rate (drops/min):</div>
        <output class="drip-rate" id="drip_rate" name="drip_rate">Please fill in all inputs</output>

        <!-- Button to send the target drip rate to ESP32 -->
        <br><br>
        <input type="button" name="set_button" value="Set" onclick="setTargetDripRate()">
        <label for="set_button">(send target drip rate to device)</label><br><br>

        <input type="button" name="set_and_run_button" value="Set and Run" onclick="setTargetDripRateAndRun()">
        <label for="set_and_run_button">(send target drip rate to device and also run)</label><br><br>
    </form>

    <table>
        <tr>
            <td>Time between 2 drops (ms): </td>
            <td>
                <div id='time_btw_2_drops_value'>Not started</div>
            </td>
        </tr>
        <tr>
            <td>No. of drops: </td>
            <td>
                <div id="num_drops_value">Not started</div>
            </td>
        </tr>
        <tr>
            <td class="highlight-section">Drip rate (drops/min): </td>
            <td>
                <div id="drip_rate_value">Not started</div>
            </td>
        </tr>

        <tr>
            <td class="highlight-section">Infused volume (mL): </td>
            <td>
                <div id="infused_volume_value">Not started</div>
            </td>
        </tr>
        <tr>
            <td class="highlight-section">Infused time: </td>
            <td>
                <div id="infused_time_value">Not started</div>
            </td>
        </tr>
        <tr>
            <td class="highlight-section">Infusion state: </td>
            <td>
                <div id="infusion_state_value">Not started</div>
            </td>
        </tr>
    </table>
    <br>

    <button type="button" id="download_infusion_data_btn" disabled onclick="downloadInfusionData()">Download Infusion Data</button>


    <!-- <iframe style="display:none" name="hidden-form"></iframe>

    <div id='sendsensor'>testing value</div>
    <figure class="highcharts-figure">
        <div id="chart-reading" class="container">testing</div>
    </figure> -->

    <script src="script.js"></script>

</body>

</html>